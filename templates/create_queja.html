{% extends 'base.html' %}

{% block content %}
<div class="row">
	<div class="col-md-8 offset-md-2">
		<div class="card shadow-sm mt-4">
					<div class="card-header">
						<h5 class="text-white">Crear Queja</h5>
					</div>
			<div class="card-body">
				{% if error %}
				<div class="alert alert-danger">{{ error }}</div>
				{% endif %}

				{% if success %}
				<div class="alert alert-success">{{ success }}</div>
				{% endif %}

						<form method="post">
							{% csrf_token %}
							<div class="row">
								<div class="col-md-6 mb-3">
									<label class="form-label">Folio</label>
									<input name="folio" class="form-control" required />
								</div>
								<div class="col-md-6 mb-3">
									<label class="form-label">Fecha de recepción</label>
									<input type="date" name="fecha_recepcion" class="form-control" required />
								</div>

								<div class="col-md-6 mb-3">
									<label class="form-label">Medio de recepción</label>
									<select name="medio_id" class="form-control">
										<option value="">-- Seleccione --</option>
										{% for m in medios %}
											{% if m.id %}
											<option value="{{ m.id }}">{{ m.nombre|default:m.name|default:m.label }}</option>
											{% else %}
											<option value="{{ m }}">{{ m }}</option>
											{% endif %}
										{% endfor %}
									</select>
								</div>

								<div class="col-md-6 mb-3">
									<label class="form-label">Nivel de atención</label>
									<select name="nivel_id" class="form-control">
										<option value="">-- Seleccione --</option>
										{% for n in niveles %}
											{% if n.id %}
											<option value="{{ n.id }}">{{ n.nombre|default:n.name|default:n.label }}</option>
											{% else %}
											<option value="{{ n }}">{{ n }}</option>
											{% endif %}
										{% endfor %}
									</select>
								</div>

								<div class="col-md-6 mb-3">
									<label class="form-label">Producto (código)</label>
									<input name="producto" class="form-control" />
								</div>

								<div class="col-md-6 mb-3">
									<label class="form-label">Causa (id)</label>
									<input name="causas_id" class="form-control" />
								</div>

								<div class="col-md-4 mb-3">
									<label class="form-label">Estado</label>
									<select name="estado_id" class="form-control">
										<option value="">-- Seleccione --</option>
										{% for e in estados %}
											{% if e.id %}
											<option value="{{ e.id }}">{{ e.nombre|default:e.name|default:e.estado }}</option>
											{% else %}
											<option value="{{ e }}">{{ e }}</option>
											{% endif %}
										{% endfor %}
									</select>
								</div>

								<div class="col-md-4 mb-3">
									<label class="form-label">Municipio</label>
									<input name="municipio" class="form-control" />
								</div>

								<div class="col-md-4 mb-3">
									<label class="form-label">Colonia</label>
									<input name="colonia" class="form-control" />
								</div>

								<div class="col-md-4 mb-3">
									<label class="form-label">Código Postal</label>
									<input name="cp" class="form-control" />
								</div>

								<div class="col-md-4 mb-3">
									<label class="form-label">Tipo de persona</label>
									<input name="tipo_persona" class="form-control" placeholder="Ej: Física / Moral / 1 / 2" />
								</div>

								<div class="col-md-4 mb-3">
									<label class="form-label">Sexo</label>
									<select name="sexo" class="form-control">
										<option value="">-- --</option>
										<option value="M">Masculino</option>
										<option value="F">Femenino</option>
										<option value="N">No especifica</option>
									</select>
								</div>

								<div class="col-md-4 mb-3">
									<label class="form-label">Edad</label>
									<input type="number" name="edad" class="form-control" min="0" />
								</div>

								<div class="col-md-6 mb-3">
									<label class="form-label">Fecha de resolución</label>
									<input type="date" name="fecha_resolucion" class="form-control" />
								</div>

								<div class="col-md-6 mb-3">
									<label class="form-label">Fecha de notificación</label>
									<input type="date" name="fecha_notificacion" class="form-control" />
								</div>

								<div class="col-12 mb-3">
									<label class="form-label">Respuesta</label>
									<textarea name="respuesta" class="form-control" rows="4"></textarea>
								</div>
							</div>
							<div class="d-flex gap-2">
								<button class="btn btn-primary" type="submit">Enviar Queja</button>
								<a class="btn btn-secondary" href="{% url 'redeco_frontend:index' %}">Volver</a>
							</div>
						</form>

						{% if payload_text %}
						<div class="mt-3">
							<label class="form-label">Payload enviado (JSON)</label>
							<pre class="p-2 bg-light" style="max-height:300px;overflow:auto;">{{ payload_text }}</pre>
						</div>
						{% endif %}
			</div>
		</div>
	</div>
</div>
{% endblock %}
